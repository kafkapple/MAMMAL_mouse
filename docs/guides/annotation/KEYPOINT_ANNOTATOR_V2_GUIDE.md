# Enhanced Keypoint Annotator V2 μ‚¬μ© κ°€μ΄λ“

## μƒλ΅μ΄ κΈ°λ¥ (v1 λ€λΉ„)

### 1. π” ν™•λ€ κΈ°λ¥ (Zoom)
- **μ„μΉ**: μ™Όμ½ μƒλ‹¨ "Zoom Level" μ¬λΌμ΄λ”
- **λ²”μ„**: 1.0x ~ 4.0x
- **κΈ°λ³Έκ°’**: 2.0x (2λ°° ν™•λ€)
- **μ‚¬μ©λ²•**: μ¬λΌμ΄λ”λ¥Ό μ΅°μ •ν•μ—¬ μ΄λ―Έμ§€ ν¬κΈ° λ³€κ²½
- **ν¨κ³Ό**:
  - μ‘μ€ λ””ν…μΌμ„ λ” λ…ν™•ν•κ² λ³Ό μ μμ
  - μ •ν™•ν• ν‚¤ν¬μΈνΈ λ°°μΉ κ°€λ¥
  - μΆν‘λ” μλ™μΌλ΅ μ›λ³Έ ν¬κΈ°λ΅ λ³€ν™λμ–΄ μ €μ¥

**κ¶μ¥ μ„¤μ •**: 2.0x ~ 3.0x (λ„λ¬΄ ν¬λ©΄ μ΄λ―Έμ§€κ°€ ν™”λ©΄μ„ λ²—μ–΄λ‚¨)

### 2. β« ν‚¤ν¬μΈνΈ ν¬κΈ° μ΅°μ 
- **μ„μΉ**: "Point Size" μ¬λΌμ΄λ”
- **λ²”μ„**: 1 ~ 8 ν”½μ…€
- **κΈ°λ³Έκ°’**: 3 ν”½μ…€ (v1μ 6ν”½μ…€μ—μ„ κ°μ†)
- **μ‚¬μ©λ²•**: μ¬λΌμ΄λ”λ΅ λ§μ»¤ ν¬κΈ° μ΅°μ •
- **ν¨κ³Ό**:
  - μ‘μ€ ν¬κΈ°: μ •ν™•ν• μ„μΉ ν™•μΈ κ°€λ¥
  - ν° ν¬κΈ°: ν‘μ‹ μ λ³΄μ„
  - Zoomκ³Ό ν•¨κ» μ΅°μ •ν•λ©΄ μµμ ν™” κ°€λ¥

**κ¶μ¥ μ„¤μ •**:
- Zoom 1.0x-2.0x: Point Size 3-4
- Zoom 3.0x-4.0x: Point Size 2-3

### 3. π‘οΈ Visibility (κ°€μ‹μ„±) μ²λ¦¬
- **μƒλ΅μ΄ κΈ°λ¥**: λ³΄μ΄μ§€ μ•κ±°λ‚ λ¶ν™•μ‹¤ν• ν‚¤ν¬μΈνΈ μ²λ¦¬ κ°€λ¥
- **3κ°€μ§€ μƒνƒ**:

  1. **Visible (1.0)** - λ…ν™•ν•κ² λ³΄μ„
     - κΈ°λ³Έ μƒνƒ
     - μ±„μ›μ§„ μ›μΌλ΅ ν‘μ‹
     - μ •ν™•ν• μ„μΉ ν΄λ¦­

  2. **Occluded (0.5)** - λ¶€λ¶„μ μΌλ΅ κ°€λ ¤μ§/λ¶ν™•μ‹¤
     - λ€λµμ μΈ μ„μΉλ” μ•μ§€λ§ μ •ν™•ν•μ§€ μ•μ
     - λΉ μ›(hollow circle)μΌλ΅ ν‘μ‹
     - μ: λ‹¤λ¥Έ μ‹ μ²΄ λ¶€μ„μ— κ°€λ ¤μ§„ κ²½μ°

  3. **Not Visible (0.0)** - μ „ν€ λ³΄μ΄μ§€ μ•μ
     - ν‚¤ν¬μΈνΈ μ„μΉλ¥Ό μ „ν€ μ• μ μ—†μ
     - ν™”λ©΄μ— ν‘μ‹λμ§€ μ•μ
     - νμΌμ—λ” visibility=0.0μΌλ΅ μ €μ¥λ¨

## μ‚¬μ© λ°©λ²•

### κΈ°λ³Έ μ›ν¬ν”λ΅μ°

1. **ν”„λ μ„ λ΅λ“**
   - μ¬λΌμ΄λ”λ΅ ν”„λ μ„ μ„ νƒ λλ” Prev/Next λ²„νΌ
   - μλ™μΌλ΅ μ΄λ―Έμ§€μ™€ κΈ°μ΅΄ ν‚¤ν¬μΈνΈ λ΅λ“

2. **Zoom λ° Point Size μ΅°μ •**
   - μ²μμ— Zoomμ„ 2.0x ~ 3.0xλ΅ μ„¤μ •
   - Point Sizeλ¥Ό 3μΌλ΅ μ μ§€ (λλ” ν•„μ”μ— λ”°λΌ μ΅°μ •)

3. **ν‚¤ν¬μΈνΈ μ¶”κ°€**
   - ν‚¤ν¬μΈνΈ μ„ νƒ (μ: "nose")
   - Visibility μƒνƒ μ„ νƒ:
     - λ…ν™•ν λ³΄μ„ β†’ "visible" (κΈ°λ³Έκ°’)
     - μ•½κ°„ κ°€λ ¤μ§ β†’ "occluded"
     - μ „ν€ μ•λ³΄μ„ β†’ "not_visible"
   - μ΄λ―Έμ§€μ—μ„ μ„μΉ ν΄λ¦­
   - λλ” "Mark Current as NOT VISIBLE" λ²„νΌ ν΄λ¦­ (μ „ν€ μ•λ³΄μ΄λ” κ²½μ°)

4. **λ¨λ“  ν‚¤ν¬μΈνΈ λ°λ³µ**
   - nose, neck, spine_mid, hip, tail_base (ν•„μ)
   - left_ear, right_ear (μ„ νƒ)

5. **μ €μ¥**
   - "π’Ύ Save Keypoints" ν΄λ¦­
   - μλ™μΌλ΅ `data/keypoints_manual.json`μ— μ €μ¥

6. **λ‹¤μ ν”„λ μ„**
   - "Next β΅οΈ" λ²„νΌ λλ” μ¬λΌμ΄λ”

### μ‹¤μ „ ν

**ν™•λ€/μ¶•μ† μ‚¬μ©**:
```
λ‚®μ€ Zoom (1.0x-1.5x): μ „μ²΄ κµ¬μ΅° νμ•…
μ¤‘κ°„ Zoom (2.0x-3.0x): μ •ν™•ν• ν‚¤ν¬μΈνΈ λ°°μΉ (κ¶μ¥)
λ†’μ€ Zoom (3.5x-4.0x): λ§¤μ° μ‘μ€ λ””ν…μΌ ν™•μΈ
```

**Visibility νλ‹¨ κΈ°μ¤€**:
```
Visible (1.0):
  - κ²½κ³„κ°€ λ…ν™•ν•¨
  - μ •ν™•ν• μ„μΉ ν΄λ¦­ κ°€λ¥
  - λ€λ¶€λ¶„μ κ²½μ°

Occluded (0.5):
  - κ²½κ³„κ°€ νλ¦Ών•κ±°λ‚ λ¶€λ¶„μ μΌλ΅ κ°€λ ¤μ§
  - λ€λµμ μΈ μ„μΉλ§ μ• μ μμ
  - "μ•„λ§λ„ μ—¬κΈ°μ―¤?" ν•λ” κ²½μ°

Not Visible (0.0):
  - μ™„μ „ν κ°€λ ¤μ§
  - μ΄λ―Έμ§€ λ°–
  - κ°λ„ λ•λ¬Έμ— λ³΄μ΄μ§€ μ•μ
  - μ„μΉλ¥Ό μ „ν€ μ¶”μ •ν•  μ μ—†λ” κ²½μ°
```

**ν¨μ¨μ μΈ Annotation**:
1. μ²« ν”„λ μ„: λ¨λ“  μ„¤μ • μ΅°μ • (Zoom, Point Size)
2. μ΄ν›„ ν”„λ μ„: λ™μΌ μ„¤μ • μ μ§€ν•λ©° λΉ λ¥΄κ² μ§„ν–‰
3. λΉ„μ·ν• μμ„Έ: μ΄μ „ ν”„λ μ„ μ„μΉ μ°Έκ³ 
4. λ‹¤λ¥Έ μμ„Έ: Zoom μ΅°μ •ν•μ—¬ ν™•μΈ

## μ¶λ ¥ ν•μ‹

`data/keypoints_manual.json`:

```json
{
  "frame_000000": {
    "nose": {"x": 125.3, "y": 89.2, "visibility": 1.0},
    "neck": {"x": 118.5, "y": 102.1, "visibility": 1.0},
    "spine_mid": {"x": 110.2, "y": 115.3, "visibility": 0.5},
    "hip": {"x": 95.1, "y": 128.4, "visibility": 1.0},
    "tail_base": {"x": 82.3, "y": 135.7, "visibility": 1.0},
    "left_ear": {"x": 130.0, "y": 85.0, "visibility": 0.0}
  }
}
```

- `x, y`: μ›λ³Έ μ΄λ―Έμ§€ μΆν‘ (Zoom μ μ© μ „)
- `visibility`: 0.0 (μ•λ³΄μ„), 0.5 (λ¶€λ¶„), 1.0 (λ…ν™•)

## μ‹¤ν–‰ λ°©λ²•

```bash
# ν„μ¬ μ‹¤ν–‰ μ¤‘ (port 7861)
# λΈλΌμ°μ €μ—μ„ μ ‘μ†:
http://localhost:7861

# SSH ν„°λ„λ§ (μ›κ²© μ„λ²„)
ssh -N -L 7861:localhost:7861 user@server

# κ·Έ ν›„ λ΅μ»¬ λΈλΌμ°μ €:
http://localhost:7861
```

## ν‚¤λ³΄λ“ λ‹¨μ¶•ν‚¤

- μ¬λΌμ΄λ” ν¬μ»¤μ¤ ν›„ ν™”μ‚΄ν‘ ν‚¤: ν”„λ μ„ μ΄λ™
- λΈλΌμ°μ € ν™•λ€/μ¶•μ†: Ctrl/Cmd + Plus/Minus (μ „μ²΄ UI ν™•λ€)

## λ¬Έμ  ν•΄κ²°

### μ΄λ―Έμ§€κ°€ λ„λ¬΄ μ»¤μ„ ν™”λ©΄μ„ λ²—μ–΄λ‚¨
- Zoomμ„ λ‚®μ¶¤ (2.0x β†’ 1.5x)
- λΈλΌμ°μ € ν™•λ€μ¨ μ΅°μ • (Ctrl/Cmd + Minus)

### ν‚¤ν¬μΈνΈκ°€ λ„λ¬΄ μ‘μ•„μ„ μ•λ³΄μ„
- Point Size μ¦κ°€ (3 β†’ 5)
- Zoom μ¦κ°€ (2.0x β†’ 3.0x)

### μ‹¤μλ΅ μλ»λ μ„μΉ ν΄λ¦­
- κ°™μ€ ν‚¤ν¬μΈνΈλ¥Ό λ‹¤μ‹ μ„ νƒν•κ³  μ¬λ°”λ¥Έ μ„μΉ ν΄λ¦­ (λ®μ–΄μ“°κΈ°)
- λλ” Remove κΈ°λ¥ μ‚¬μ©

### Visibilityλ¥Ό μλ» μ„¤μ •
- κ°™μ€ ν‚¤ν¬μΈνΈλ¥Ό μ¬λ°”λ¥Έ Visibilityλ΅ λ‹¤μ‹ ν΄λ¦­

## V1κ³Όμ μ°¨μ΄μ 

| κΈ°λ¥ | V1 | V2 |
|------|----|----|
| Zoom | β μ—†μ | β… 1.0x-4.0x |
| Point Size | 6 ν”½μ…€ κ³ μ • | 1-8 ν”½μ…€ μ΅°μ  |
| Visibility | ν•­μƒ 1.0 | 3λ‹¨κ³„ (0.0, 0.5, 1.0) |
| Not Visible μ²λ¦¬ | β λ¶κ°€λ¥ | β… λ²„νΌ μ κ³µ |
| μΆν‘ μ •ν™•λ„ | λ‚®μ | λ†’μ (ν™•λ€λ΅ μΈν•΄) |

## μμƒ μ‹κ°„

- **20 ν”„λ μ„ μ „μ²΄**: 30-40λ¶„
- **ν”„λ μ„λ‹Ή**: 1.5-2λ¶„
  - Zoom/ν¬κΈ° μ΅°μ •: 10μ΄
  - 7κ° ν‚¤ν¬μΈνΈ ν΄λ¦­: 1λ¶„
  - μ €μ¥ λ° λ‹¤μ ν”„λ μ„: 20μ΄

## λ‹¤μ λ‹¨κ³„

Annotation μ™„λ£ ν›„ (`data/keypoints_manual.json` μƒμ„±):

```bash
# Keypoint κΈ°λ° Mesh Fitting μ‹¤ν–‰
python fit_with_keypoints.py \
    data/100-KO-male-56-20200615_cropped \
    --keypoints data/keypoints_manual.json \
    --output results/keypoint_fitting
```

**μμƒ κ°μ„ **:
- IoU: ~46% (silhouetteλ§) β†’ ~65-75% (keypoint + silhouette)
- Pose μ •ν™•λ„: ν¬κ² ν–¥μƒ
- μλ ΄ μ†λ„: λ” λΉ λ¦„
