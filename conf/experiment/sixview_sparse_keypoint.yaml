# @package _global_
# Experiment 4: 6-view RGB with sparse keypoints (nose, body center, tail base only)
# Tests reconstruction with minimal keypoint annotation (3 points).
#
# Usage:
#   Debug:  ./run_experiment.sh sixview_sparse_keypoint --debug
#   Full:   ./run_experiment.sh sixview_sparse_keypoint

defaults:
  - override /dataset: markerless

# Experiment metadata
experiment_name: sixview_sparse_keypoint
experiment_description: "6-view RGB with 3 sparse keypoints (nose, tail_base, neck)"

data:
  views_to_use: [0, 1, 2, 3, 4, 5]

fitter:
  render_cameras: [0, 1, 2, 3, 4, 5]
  use_keypoints: true
  keypoint_num: 22
  # Sparse keypoint indices (GT annotation 기준 - mouse_22_defs.py):
  #   idx 2: Nose (GT에서 nose는 index 2)
  #   idx 5: Tail root
  #   idx 3: Neck
  sparse_keypoint_indices: [2, 5, 3]
  with_render: true

# Slightly more iterations for sparse keypoints
optim:
  solve_step0_iters: 15
  solve_step1_iters: 150
  solve_step2_iters: 45

# Loss weights for sparse keypoint mode
loss_weights:
  theta: 5.0           # Moderate regularization
  "3d": 2.5
  "2d": 0.5            # Higher weight on available keypoints
  bone: 1.0
  scale: 1.0
  chest_deformer: 0.1
  stretch: 1.0
  temp: 0.35           # Moderate temporal smoothing
  temp_d: 0.3
  mask_step0: 0.0
  mask_step1: 500.0    # Use mask earlier to compensate
  mask_step2: 3000.0

# Keypoint weights - only sparse points have weight
keypoint_weights:
  default: 0.0         # Zero weight for unused keypoints
  idx_2: 5.0           # Nose (GT index 2) - high weight
  idx_5: 3.0           # Tail base (lumbar + tail_0)
  idx_3: 5.0           # Neck/Body center - high weight
  tail_step2: 10.0
