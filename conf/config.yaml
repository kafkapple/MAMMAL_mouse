# @package _global_

defaults:
  - _self_
  - dataset: shank3  # Options: markerless, shank3, custom
  - preprocess: opencv  # Options: opencv, sam (future)
  - optim: fast  # Options: fast, accurate
  - override hydra/job_logging: default
  - override hydra/hydra_logging: default

# Global settings
mode: multi_view  # Options: multi_view, single_view_preprocess

# Data settings (can be overridden by dataset config or --input_dir CLI argument)
# NOTE: Use relative paths or override with --input_dir for portability across servers
data:
  data_dir: data/examples/markerless_mouse_1_nerf/  # Default example dataset (override with --input_dir)
  views_to_use: [0]

# Preprocessing settings (can be overridden by preprocess config)
preprocess:
  input_video_path: data/shank3/100-KO-male-56-20200615.avi
  output_data_dir: data/preprocessed_shank3/

# Fitter settings
fitter:
  start_frame: 0
  end_frame: 2
  interval: 1
  resume: false
  with_render: false
  keypoint_num: 22
  render_cameras: [0]
  use_keypoints: true  # Set to false to disable keypoint loss (silhouette only)

# Silhouette-only mode settings (only used when use_keypoints=false)
silhouette:
  # Iteration multiplier for silhouette-only mode (1.0 = same as keypoint mode)
  iter_multiplier: 2.0
  # Theta (pose) regularization weight (higher = less pose variation)
  theta_weight: 10.0  # Default with keypoints is 3.0
  # Bone length regularization weight
  bone_weight: 2.0  # Default is 0.5
  # Scale regularization weight
  scale_weight: 50.0  # Default is 0.5
  # Use mask PCA for initial rotation estimation
  use_pca_init: true

# Optimization settings (can be overridden by optim config)
optim:
  solve_step0_iters: 10
  solve_step1_iters: 100
  solve_step2_iters: 30

# Paths (all results go to results/ folder)
result_folder: results/fitting/

# Hydra configuration
hydra:
  run:
    dir: results/logs/${now:%Y-%m-%d}/${now:%H-%M-%S}
  job:
    chdir: false  # Important: Do not change working directory
